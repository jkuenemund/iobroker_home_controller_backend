<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Home Controller</title>

    <!-- Load ioBroker socket.io -->
    <script type="text/javascript" src="../../socket.io/socket.io.js"></script>

    <link rel="stylesheet" href="./css/base.css">
    <link rel="stylesheet" href="./css/metrics.css">
</head>

<body>
    <div class="container">
        <div class="header-controls">
            <h1><span style="font-size: 1.2em;">üëã</span> Home Controller</h1>
            <div class="config-info">
                Base Path: <code id="basePath"
                    style="background: #eee; padding: 2px 6px; border-radius: 4px;">Loading...</code>
                <span class="status" id="status" style="background: #999; margin-left: 10px;">Connecting...</span>
                <span id="metricsTimer" class="metrics-timer"></span>
            </div>
        </div>

        <!-- WebSocket Clients Section -->
        <div class="clients-section">
            <div class="clients-header">
                üîå WebSocket Clients
            </div>
            <div class="clients-list" id="clientsList">
                <span class="no-clients">No clients connected</span>
            </div>
        </div>

        <div class="tabs">
            <button class="tab-button active" onclick="switchTab('devices')">Devices</button>
            <button class="tab-button" onclick="switchTab('rooms')">Rooms</button>
            <button class="tab-button" onclick="switchTab('scenes')">Scenes</button>
            <div class="action-buttons">
                <button class="action-btn export" onclick="exportData()">‚¨áÔ∏è Export</button>
                <button class="action-btn import" onclick="document.getElementById('importFile').click()">‚¨ÜÔ∏è
                    Import</button>
                <button class="action-btn reload" onclick="loadData()">üîÑ Reload</button>
                <button class="action-btn add" onclick="openAddDialog()">‚ûï Add</button>
            </div>
            <input type="file" id="importFile" accept=".json" style="display: none;" onchange="handleImportFile(event)">
        </div>

        <div class="table-container">
            <table id="deviceTable">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Value</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td colspan="2" style="text-align: center; color: #999;">Select a tab to load data</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Add Modal -->
    <div class="modal-overlay" id="addModal">
        <div class="modal">
            <h2 id="modalTitle">Add New Device</h2>
            <div class="error-message" id="errorMessage"></div>
            <div class="form-group">
                <label for="itemId">ID (unique identifier, e.g., kitchen_light)</label>
                <input type="text" id="itemId" placeholder="Enter unique ID...">
            </div>
            <div class="form-group">
                <label for="itemConfig">Configuration (JSON)</label>
                <textarea id="itemConfig"></textarea>
            </div>
            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="closeAddDialog()">Cancel</button>
                <button class="btn btn-primary" onclick="saveNewItem()">Save</button>
            </div>
        </div>
    </div>

    <script src="./js/helpers.js?v=20260117"></script>
    <script src="./js/devices.js?v=20260117"></script>
    <script src="./js/rooms.js?v=20260117"></script>
    <script src="./js/scenes.js?v=20260117"></script>
    <script src="./js/modals.js?v=20260117"></script>
    <script src="./js/app.js?v=20260117"></script>
</body>

</html>